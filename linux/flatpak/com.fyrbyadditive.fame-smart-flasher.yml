app-id: com.fyrbyadditive.fame-smart-flasher
runtime: org.kde.Platform
runtime-version: '6.7'
sdk: org.kde.Sdk
command: fame-smart-flasher

finish-args:
  # Access to serial devices (/dev/ttyUSB*, /dev/ttyACM*)
  - --device=all
  # Display
  - --socket=wayland
  - --socket=fallback-x11
  - --share=ipc
  # File access for firmware files
  - --filesystem=home:ro
  - --filesystem=/tmp:rw

modules:
  - name: libudev
    buildsystem: simple
    build-commands:
      - mkdir -p /app/lib
    sources: []
    # Note: libudev is provided by the runtime

  - name: fame-smart-flasher
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=Release
    sources:
      - type: dir
        path: ..
    post-install:
      - install -Dm644 flatpak/com.fyrbyadditive.fame-smart-flasher.desktop /app/share/applications/com.fyrbyadditive.fame-smart-flasher.desktop
      - install -Dm644 resources/icons/app-icon.svg /app/share/icons/hicolor/scalable/apps/com.fyrbyadditive.fame-smart-flasher.svg
      - install -Dm644 flatpak/com.fyrbyadditive.fame-smart-flasher.metainfo.xml /app/share/metainfo/com.fyrbyadditive.fame-smart-flasher.metainfo.xml
